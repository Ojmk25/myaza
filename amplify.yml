version: 1
applications:
  - appRoot: web-content/
    frontend:
      buildPath: web-content # Run install and build from the web-content folder
      phases:
        preBuild:
          commands:
            - echo Entered the pre-build phase...
            - pwd
            # - cd web-content
            - npm install --force
    
        build:
          commands:
            # - npm install --force
            - echo "🛠️ Setting up your environmental variables..."
            - echo "NEXT_PUBLIC_FRONTEGG_APP_URL=$FRONTEGG_APP_URL" >> .env
            - echo "NEXT_PUBLIC_FRONTEGG_BASE_URL=$FRONTEGG_BASE_URL" >> .env
            - echo "NEXT_PUBLIC_FRONTEGG_CLIENT_ID=$FRONTEGG_CLIENT_ID" >> .env
            - echo "NEXT_PUBLIC_FRONTEGG_APP_ID=$FRONTEGG_APP_ID" >> .env
            - echo "NEXT_PUBLIC_FRONTEGG_COOKIE_NAME=$FRONTEGG_COOKIE_NAME" >> .env
            - echo "NEXT PUBLIC_FRONTEGG_ENCRYPTION_PASSWORD=$FRONTEGG_ENCRYPTION_PASSWORD" >> .env
            - echo "NEXT_PUBLIC_FRONTEGG_HOSTED_LOGIN=$FRONTEGG_HOSTED_LOGIN" >> .env
            - echo "NEXT_PUBLIC_REGION=$REGION" >> .env
            - echo "Printing environmental variables to the console to ensure they are correct"
            - cat .env
            - npm run build
            - echo "✅ Success!"
      artifacts:
        baseDirectory: build
        files:
          - "**/*"
      cache:
        paths:
          - node_modules/**/*
            

